(()=>{"use strict";var t,i,e,n={8337:(t,i,e)=>{var n=e(3832);const o=window;class s{constructor(t,i,e,n,o){this.entities={},this.isMouseDown=!1,this.start=()=>this.application.start(),this.stop=()=>this.application.stop(),this.pondRef=t,this.element=i,this.width=e,this.height=n,this.gridSize=o,this.init()}init(){this.application&&(console.debug("Removing PIXI instance"),this.application.view.parentNode.removeChild(this.application.view),this.application.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.application=null,this.element.children.item(0)&&this.element.removeChild(this.element.children.item(0))),console.debug("Creating PIXI instance"),this.application=new n.Mx({width:this.width*this.gridSize,height:this.height*this.gridSize}),this.application.renderer.plugins.interaction.cursorStyles.default="none",this.element.appendChild(this.application.view),this.application.stage.x=this.application.view.width/2,this.application.stage.y=this.application.view.height/2,this.application.stage.width=this.application.view.width,this.application.stage.height=this.application.view.height,this.application.ticker.add((()=>this.onTick())),this.entityHolder=new n.W2,this.application.stage.addChild(this.entityHolder),this.fps=new n.xv("FPS: ??",{fill:11206570,fontSize:8}),this.fps.x=-this.application.view.width/2,this.fps.y=-this.application.view.height/2,this.application.stage.addChild(this.fps),this.cursor=new n.TC,this.cursor.beginFill(16777215),this.cursor.drawCircle(this.gridSize/2,this.gridSize/2,this.gridSize/2),this.cursor.endFill(),this.cursor.position.x=0,this.cursor.position.y=0,this.application.stage.addChild(this.cursor),this.application.stage.interactive=!0,this.application.view.addEventListener("mousemove",(t=>this.onMouseMove(t))),this.application.view.addEventListener("mousedown",(t=>this.onMouseDown(t))),this.application.view.addEventListener("mouseup",(t=>this.onMouseUp(t)))}onMouseMove(t){const i=this.getGridPosition(t);this.cursor.position.x=i.x*this.gridSize,this.cursor.position.y=i.y*this.gridSize,this.lastGridLocation=i}onMouseDown(t){t.stopPropagation(),this.isMouseDown=!0,this.lastGridLocation=this.getGridPosition(t)}onMouseUp(t){t.stopPropagation(),this.isMouseDown=!1}onClick(t,i){this.pondRef.invokeMethodAsync("OnClick",t,i)}getGridPosition(t){const i=t.offsetX-this.application.stage.x,e=t.offsetY-this.application.stage.y;return{x:Math.round(i/this.gridSize),y:Math.round(e/this.gridSize)}}onTick(){this.fps.text=`${Math.round(n.vB.shared.FPS)} fps`,this.isMouseDown&&this.onClick(this.lastGridLocation.x,this.lastGridLocation.y)}resize(t,i,e){console.debug(`Resize: ${t}x${i} gridSize: ${e}`),this.width=t,this.height=i,this.gridSize=e,this.init()}createEntity(t,i,e,o){const s=new n.TC;s.beginFill(o),s.drawCircle(this.gridSize/2,this.gridSize/2,this.gridSize/2),s.endFill(),s.position.x=i*this.gridSize,s.position.y=e*this.gridSize,this.entities[t]=s,this.entityHolder.addChild(s)}destroyEntity(t){this.entities[t]&&(this.entities[t].destroy(),this.entities[t]=null,delete this.entities[t])}moveEntity(t,i,e){if(!this.entities[t])return;const n=this.entities[t];n.position.x=i*this.gridSize,n.position.y=e*this.gridSize}changeEntityColor(t,i){if(!this.entities[t])return;const e=this.entities[t];e.clear(),e.beginFill(i),e.drawCircle(this.gridSize/2,this.gridSize/2,this.gridSize/2),e.endFill()}processEntityChangeRequestsRaw(t){const i=o.Blazor.platform.getArrayLength(t);let e;for(e=0;e<i;e++){const{entryPtr:i,id:n,type:o}=a(t,e);if(this.entities[n])switch(o){case r.Move:const{x:t,y:o}=h(i);this.moveEntity(n,t,o);break;case r.Color:const s=l(i);this.changeEntityColor(n,s);break;case r.None:return console.debug(`Entity Changes Last Tick: ${e}`),!0;default:throw new Error("unknown type")}}return console.debug(`[FULL] Entity Changes Last Tick: ${e}`),!0}}var r;function a(t,i){const e=o.Blazor.platform.getArrayEntryPtr(t,i,16);return{entryPtr:e,id:o.Blazor.platform.readInt32Field(e,0),type:o.Blazor.platform.readInt32Field(e,4)}}function h(t){return{x:o.Blazor.platform.readInt32Field(t,8),y:o.Blazor.platform.readInt32Field(t,12)}}function l(t){return o.Blazor.platform.readInt32Field(t,8)}!function(t){t[t.None=0]="None",t[t.Move=1]="Move",t[t.Color=2]="Color"}(r||(r={}));var d=e(6610);self.MonacoEnvironment={getWorkerUrl:function(t,i){return"json"===i?"./json.worker.js":"css"===i||"scss"===i||"less"===i?"./css.worker.js":"html"===i||"handlebars"===i||"razor"===i?"./html.worker.js":"typescript"===i||"javascript"===i?"./ts.worker.js":"./editor.worker.js"}};class c{constructor(t){this.elementId=t,this.editor=d.j6.create(document.getElementById(t),{value:"",language:"csharp",theme:"vs-dark",automaticLayout:!0})}setCode(t){this.editor.setValue(t)}getCode(){return this.editor.getValue()}}var p=function(t,i,e,n){return new(e||(e=Promise))((function(o,s){function r(t){try{h(n.next(t))}catch(t){s(t)}}function a(t){try{h(n.throw(t))}catch(t){s(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(r,a)}h((n=n.apply(t,i||[])).next())}))};self.ponds={},self.lastPond=0,self.createPond=function(t,i,e,n,o){return p(this,void 0,void 0,(function*(){self.lastPond++;const r=`pond_${self.lastPond}`;return self.ponds[r]=new s(t,i,e,n,o),r}))},self.createEditor=function(t,i){return p(this,void 0,void 0,(function*(){self[i]=new c(t)}))},self.getSize=()=>[self.innerWidth,self.innerHeight],self.bindWindowResize=t=>{let i;window.onresize=()=>{clearTimeout(i),i=setTimeout((()=>t.invokeMethodAsync("OnWindowResized")),1e3)}}}},o={};function s(t){var i=o[t];if(void 0!==i)return i.exports;var e=o[t]={id:t,loaded:!1,exports:{}};return n[t].call(e.exports,e,e.exports,s),e.loaded=!0,e.exports}s.m=n,t=[],s.O=(i,e,n,o)=>{if(!e){var r=1/0;for(d=0;d<t.length;d++){for(var[e,n,o]=t[d],a=!0,h=0;h<e.length;h++)(!1&o||r>=o)&&Object.keys(s.O).every((t=>s.O[t](e[h])))?e.splice(h--,1):(a=!1,o<r&&(r=o));if(a){t.splice(d--,1);var l=n();void 0!==l&&(i=l)}}return i}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[e,n,o]},s.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return s.d(i,{a:i}),i},s.d=(t,i)=>{for(var e in i)s.o(i,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((i,e)=>(s.f[e](t,i),i)),[])),s.u=t=>t+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),i={},e="pondsharp.client:",s.l=(t,n,o,r)=>{if(i[t])i[t].push(n);else{var a,h;if(void 0!==o)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var c=l[d];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==e+o){a=c;break}}a||(h=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",e+o),a.src=t),i[t]=[n];var p=(e,n)=>{a.onerror=a.onload=null,clearTimeout(u);var o=i[t];if(delete i[t],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((t=>t(n))),e)return e(n)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),h&&document.head.appendChild(a)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),s.p="/",(()=>{var t={179:0};s.f.j=(i,e)=>{var n=s.o(t,i)?t[i]:void 0;if(0!==n)if(n)e.push(n[2]);else{var o=new Promise(((e,o)=>n=t[i]=[e,o]));e.push(n[2]=o);var r=s.p+s.u(i),a=new Error;s.l(r,(e=>{if(s.o(t,i)&&(0!==(n=t[i])&&(t[i]=void 0),n)){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;a.message="Loading chunk "+i+" failed.\n("+o+": "+r+")",a.name="ChunkLoadError",a.type=o,a.request=r,n[1](a)}}),"chunk-"+i,i)}},s.O.j=i=>0===t[i];var i=(i,e)=>{var n,o,[r,a,h]=e,l=0;if(r.some((i=>0!==t[i]))){for(n in a)s.o(a,n)&&(s.m[n]=a[n]);if(h)var d=h(s)}for(i&&i(e);l<r.length;l++)o=r[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(d)},e=self.webpackChunkpondsharp_client=self.webpackChunkpondsharp_client||[];e.forEach(i.bind(null,0)),e.push=i.bind(null,e.push.bind(e))})(),s.nc=void 0;var r=s.O(void 0,[2612,2976],(()=>s(8337)));r=s.O(r)})();